{% extends 'base.html' %}
{% load static %}

{% block title %}Advertencia{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
{% endblock %}

{% block content %}

<div class="container">
    <div class="row justify-content-center align-items-center vh-100 mx-0">
        <div class="col-md-5">
            <div class="card login-card text-center p-4 shadow-lg animate__animated animate__zoomIn">
                <div class="card-body">
                    <div class="mb-4">
                    </div>

                    <h4 class="text-success fw-bold mb-2">¡Advertencia!</h4>
                    <p class="text-muted mb-4">Credenciales Insuficientes... Por favor intente denuevo</p>

                    <div class="info-logout-box mb-4">
                        <div class="d-flex justify-content-between mb-2">
                            <span class="text-secondary small">Fecha de salida:</span>
                            <span class="fw-bold text-dark" id="currentDate"></span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span class="text-secondary small">Hora de cierre:</span>
                            <span class="fw-bold text-dark" id="currentTime"></span>
                        </div>
                        <div class="d-flex justify-content-between border-top pt-2 mt-2">
                            <span class="text-secondary small">Dirección IP:</span>
                            <span class="fw-bold text-dark">{{ ip }}</span> </div>
                        </div>
                    </div>

                    <p class="small text-secondary mb-4">Gracias por utilizar nuestros servicios en línea.</p>

                    <a href="{% url 'login' %}" class="btn btn-success w-100 py-2 rounded-pill shadow-sm">
                        <i class="bi bi-arrow-left-circle me-2"></i>Volver al Inicio
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="loader-overlay" class="loader-overlay">
    <div class="loader-content">
        <div class="spinner-bav"></div>
        <p class="mt-3 text-white fw-bold">Procesando solicitud...</p>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 1. Mostrar fecha y hora actual
    const now = new Date();
    document.getElementById('currentDate').innerText = now.toLocaleDateString();
    document.getElementById('currentTime').innerText = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

    const loader = document.getElementById('loader-overlay');

    // 2. OCULTAR EL LOADER cuando la página esté lista (Efecto al entrar/recargar)
    window.addEventListener('load', function() {
        setTimeout(() => {
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.classList.add('d-none');
            }, 500);
        }, 300); // Un pequeño delay para que no parpadee demasiado rápido
    });

    // 3. MOSTRAR EL LOADER al hacer clic en "Volver al Inicio" o cualquier enlace real
    document.addEventListener('click', function(e) {
        const link = e.target.closest('a');
        if (link) {
            const href = link.getAttribute('href');
            
            // Si el enlace tiene un destino real (como {% url 'login' %})
            if (href && href !== '#' && !href.startsWith('javascript:')) {
                loader.classList.remove('d-none');
                loader.style.opacity = '1';
                loader.querySelector('p').innerText = "Regresando al inicio...";
            }
        }
    });
});
</script>

<footer class="footer-bav">
    <div class="container text-center">
        <span class="copyright-text">
            © Copyright 2026 Banco Agrícola de Venezuela. RIF G-20005795-5
        </span>
    </div>
</footer>
{% endblock %}